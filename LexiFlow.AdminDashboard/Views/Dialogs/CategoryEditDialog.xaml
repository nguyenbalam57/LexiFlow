<Window x:Class="LexiFlow.AdminDashboard.Views.Dialogs.CategoryEditDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="Category Management"
        Height="400" Width="450"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </Window.Resources>

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,24">
            <TextBlock Text="{Binding IsCategoryEditMode, ConverterParameter='Edit Category;Create New Category', Converter={StaticResource EditModeTitleConverter}}"
                     FontSize="24" FontWeight="Bold"/>
            <TextBlock Text="Organize vocabularies with categories"
                     FontSize="14" Foreground="{DynamicResource MaterialDesignBodyLight}" Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Form Content -->
        <StackPanel Grid.Row="1">
            <!-- Category Name (Required) -->
            <TextBox Text="{Binding FormCategoryName, UpdateSourceTrigger=PropertyChanged}"
                   materialDesign:HintAssist.Hint="Category Name *"
                   Style="{StaticResource MaterialDesignOutlinedTextBox}"
                   Margin="0,0,0,20"/>

            <!-- Description -->
            <TextBox Text="{Binding FormCategoryDescription, UpdateSourceTrigger=PropertyChanged}"
                   materialDesign:HintAssist.Hint="Description"
                   Style="{StaticResource MaterialDesignOutlinedTextBox}"
                   AcceptsReturn="True" MaxLines="4"
                   Margin="0,0,0,20"/>

            <!-- Level and Type -->
            <Grid Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="8"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <ComboBox Grid.Column="0" 
                        materialDesign:HintAssist.Hint="JLPT Level"
                        Style="{StaticResource MaterialDesignOutlinedComboBox}">
                    <ComboBoxItem Content="All Levels"/>
                    <ComboBoxItem Content="N5"/>
                    <ComboBoxItem Content="N4"/>
                    <ComboBoxItem Content="N3"/>
                    <ComboBoxItem Content="N2"/>
                    <ComboBoxItem Content="N1"/>
                </ComboBox>
                
                <ComboBox Grid.Column="2" 
                        materialDesign:HintAssist.Hint="Category Type"
                        Style="{StaticResource MaterialDesignOutlinedComboBox}">
                    <ComboBoxItem Content="Vocabulary" IsSelected="True"/>
                    <ComboBoxItem Content="Grammar"/>
                    <ComboBoxItem Content="Kanji"/>
                    <ComboBoxItem Content="General"/>
                </ComboBox>
            </Grid>

            <!-- Parent Category -->
            <ComboBox ItemsSource="{Binding Categories}"
                    DisplayMemberPath="CategoryName"
                    SelectedValuePath="CategoryId"
                    materialDesign:HintAssist.Hint="Parent Category (Optional)"
                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                    Margin="0,0,0,20"/>

            <!-- Active Status -->
            <CheckBox IsChecked="{Binding FormCategoryIsActive}" Content="Active" Margin="0,0,0,16"/>

            <!-- Category Preview -->
            <Border Background="{DynamicResource MaterialDesignDivider}" 
                  CornerRadius="4" Padding="12" Margin="0,0,0,0">
                <StackPanel>
                    <TextBlock Text="Preview:" FontSize="12" FontWeight="Medium" 
                             Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                    <TextBlock Text="{Binding FormCategoryName, FallbackValue='Category Name'}" 
                             FontSize="14" FontWeight="Medium" Margin="0,4,0,0"/>
                    <TextBlock Text="{Binding FormCategoryDescription, FallbackValue='Category description will appear here'}" 
                             FontSize="12" Foreground="{DynamicResource MaterialDesignBodyLight}" 
                             TextWrapping="Wrap" Margin="0,2,0,0"/>
                </StackPanel>
            </Border>
        </StackPanel>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,24,0,0">
            <Button Style="{StaticResource MaterialDesignOutlinedButton}"
                  Content="Cancel" Click="Cancel_Click" Margin="0,0,8,0" MinWidth="80"/>
            
            <Button Style="{StaticResource MaterialDesignRaisedButton}"
                  Content="{Binding IsCategoryEditMode, ConverterParameter='Update;Create', Converter={StaticResource EditModeTitleConverter}}"
                  Command="{Binding SaveCategoryCommand}"
                  Background="{DynamicResource SecondaryHueMidBrush}"
                  MinWidth="80"/>
        </StackPanel>
    </Grid>
</Window>